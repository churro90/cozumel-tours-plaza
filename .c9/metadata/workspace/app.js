{"filter":false,"title":"app.js","tooltip":"/app.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":18,"column":12},"end":{"row":18,"column":13},"action":"insert","lines":["o"],"id":6682}],[{"start":{"row":18,"column":13},"end":{"row":18,"column":14},"action":"insert","lines":["u"],"id":6683}],[{"start":{"row":18,"column":14},"end":{"row":18,"column":15},"action":"insert","lines":["t"],"id":6684}],[{"start":{"row":18,"column":15},"end":{"row":18,"column":16},"action":"insert","lines":["e"],"id":6685}],[{"start":{"row":18,"column":16},"end":{"row":18,"column":17},"action":"insert","lines":["s"],"id":6686}],[{"start":{"row":17,"column":16},"end":{"row":17,"column":17},"action":"insert","lines":["s"],"id":6687}],[{"start":{"row":49,"column":25},"end":{"row":49,"column":26},"action":"insert","lines":["s"],"id":6688}],[{"start":{"row":50,"column":25},"end":{"row":50,"column":26},"action":"insert","lines":["s"],"id":6689}],[{"start":{"row":17,"column":44},"end":{"row":17,"column":45},"action":"remove","lines":["x"],"id":6690}],[{"start":{"row":17,"column":43},"end":{"row":17,"column":44},"action":"remove","lines":["e"],"id":6691}],[{"start":{"row":17,"column":42},"end":{"row":17,"column":43},"action":"remove","lines":["d"],"id":6692}],[{"start":{"row":17,"column":41},"end":{"row":17,"column":42},"action":"remove","lines":["n"],"id":6693}],[{"start":{"row":17,"column":40},"end":{"row":17,"column":41},"action":"remove","lines":["i"],"id":6694}],[{"start":{"row":17,"column":40},"end":{"row":17,"column":41},"action":"insert","lines":["c"],"id":6695}],[{"start":{"row":17,"column":41},"end":{"row":17,"column":42},"action":"insert","lines":["o"],"id":6696}],[{"start":{"row":17,"column":42},"end":{"row":17,"column":43},"action":"insert","lines":["n"],"id":6697}],[{"start":{"row":17,"column":43},"end":{"row":17,"column":44},"action":"insert","lines":["t"],"id":6698}],[{"start":{"row":17,"column":44},"end":{"row":17,"column":45},"action":"insert","lines":["a"],"id":6699}],[{"start":{"row":17,"column":45},"end":{"row":17,"column":46},"action":"insert","lines":["c"],"id":6700}],[{"start":{"row":17,"column":46},"end":{"row":17,"column":47},"action":"insert","lines":["t"],"id":6701}],[{"start":{"row":18,"column":44},"end":{"row":18,"column":45},"action":"remove","lines":["x"],"id":6702}],[{"start":{"row":18,"column":43},"end":{"row":18,"column":44},"action":"remove","lines":["e"],"id":6703}],[{"start":{"row":18,"column":42},"end":{"row":18,"column":43},"action":"remove","lines":["d"],"id":6704}],[{"start":{"row":18,"column":41},"end":{"row":18,"column":42},"action":"remove","lines":["n"],"id":6705}],[{"start":{"row":18,"column":40},"end":{"row":18,"column":41},"action":"remove","lines":["i"],"id":6706}],[{"start":{"row":18,"column":40},"end":{"row":18,"column":41},"action":"insert","lines":["b"],"id":6707}],[{"start":{"row":18,"column":41},"end":{"row":18,"column":42},"action":"insert","lines":["o"],"id":6708}],[{"start":{"row":18,"column":42},"end":{"row":18,"column":43},"action":"insert","lines":["o"],"id":6709}],[{"start":{"row":18,"column":43},"end":{"row":18,"column":44},"action":"insert","lines":["k"],"id":6710}],[{"start":{"row":18,"column":44},"end":{"row":18,"column":45},"action":"insert","lines":["i"],"id":6711}],[{"start":{"row":18,"column":45},"end":{"row":18,"column":46},"action":"insert","lines":["n"],"id":6712}],[{"start":{"row":18,"column":46},"end":{"row":18,"column":47},"action":"insert","lines":["g"],"id":6713}],[{"start":{"row":53,"column":0},"end":{"row":135,"column":0},"action":"remove","lines":["//==================BOOKING ROUTES================","","app.get(\"/booking\", function(req, res) {","    Country.find({}, function(err, Countries){","        if(err){","            console.log(err);","        } ","        else {","            res.render(\"booking\", {countries: Countries});","        }","    })","    ","});","","app.get(\"/payment\", function(req, res) {","   res.render(\"payment\"); ","});","","app.post(\"/booking\", function(req, res) {","    var subject = req.body.firstName + \" \" + req.body.lastName + \" \" + req.body.date + \" NR\";","    var output = `","     <h1> Tienes una nueva solicitud de reserva:</h1>","     <br>","     <h3>Detalles</h3>","     <ul>","        <li>Nombre: ${req.body.firstName} ${req.body.lastName} </li>","        <li>Email:  ${req.body.email} </li>","        <li>Fecha:  ${req.body.date} </li>","        <li>Hora:   ${req.body.startTime} </li>","        <li>Hotel or ship:  ${req.body.arrival} </li>","        <li>Crucero/Hotel:  ${req.body.hotelOrCruise} </li>","        <li>Tipo de servicio:  ${req.body.vehicle} </li>","        <li>Numero de personas:  ${req.body.people} </li>","        <li>Pais:  ${req.body.country} </li>","        <li>Celular:  ${req.body.areaCode}${req.body.cellphone}  </li>","        <li>Comentarios:  ${req.body.info} </li>","        <li>Requerimientos:  ${req.body.requirements} </li>","        <li>Item adicionales:  ${req.body.babySeat} </li>","    </ul>","    `;","    "," nodemailer.createTestAccount((err, account) => {","","    // create reusable transporter object using the default SMTP transport","    let transporter = nodemailer.createTransport({","        host: 'smtp.gmail.com',","        port: 465,","        secure: true, // true for 465, false for other ports","        auth: {","            user: process.env.GMAIL_ACCOUNT, // generated ethereal user","            pass: process.env.GMAIL_PASSWORD // generated ethereal password","        },","        tls:{","            rejectUnauthorized: false","        }","    });","","    // setup email data with unicode symbols","    let mailOptions = {","        from: process.env.GMAIL_ACCOUNT, // sender address","        to:   process.env.RECEIVER,","        replyTo: req.body.email,// list of receivers","        subject: subject, // Subject line","        html: output // html body","    };","","    // send mail with defined transport object","    transporter.sendMail(mailOptions, (error, info) => {","        if (error) {","            req.flash(\"error\", \"There was an error submiting your reservation, please contact us directly at eduardoczm@gmail.com or try again\");","            return res.redirect(\"booking\");","        }","            else {","        ","        return res.render(\"payment\", {\"success\":\"Your reservation was succesfully submited\",","           info: req.body }","        );","            }","    });","});  ","});","",""],"id":6714}],[{"start":{"row":56,"column":0},"end":{"row":122,"column":0},"action":"remove","lines":["// =============CONTACT ROUTES==========","app.get(\"/contact\", function(req, res){","   res.render(\"contact\"); ","});","","app.post(\"/contact\", function(req, res){","    var subject= req.body.subject;","    var email = req.body.email;","    var output = `","     <h1> Tienes una nueva consulta:</h1>","     <br>","     <h3>Detalles del contacto</h3>","     <ul>","        <li>Nombre: ${req.body.name} </li>","        <li>Email:  ${req.body.email} </li>","    </ul>","    <h3>Mensaje</h3>","    <p> ${req.body.message}</p>","     </ul>","    `;","    ","   ","","// Generate test SMTP service account from ethereal.email","// Only needed if you don't have a real mail account for testing","nodemailer.createTestAccount((err, account) => {","","    // create reusable transporter object using the default SMTP transport","    let transporter = nodemailer.createTransport({","        host: 'smtp.gmail.com',","        port: 465,","        secure: true, // true for 465, false for other ports","        auth: {","            user: process.env.GMAIL_ACCOUNT, // generated ethereal user","            pass: process.env.GMAIL_PASSWORD // generated ethereal password","        },","        tls:{","            rejectUnauthorized: false","        }","    });","","    // setup email data with unicode symbols","    let mailOptions = {","        from: process.env.GMAIL_ACCOUNT, // sender address","        to:   process.env.RECEIVER,","        replyTo: email, // list of receivers","        subject: subject, // Subject line","        html: output // html body","    };","","    // send mail with defined transport object","    transporter.sendMail(mailOptions, (error, info) => {","        if (error) {","            req.flash(\"error\", \"There was an error submiting your form, please contact us directly at eduardoczm@gmail.com or try again\");","            console.log(error);","            return res.redirect(\"contact\");","        } else {","       ","       req.flash(\"success\", \"Message sent successfully, we will get back to you as soon as possible\");","       return res.redirect(\"contact\");","        ","        }","    });","});","});","    ",""],"id":6715}],[{"start":{"row":51,"column":4},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":6716}],[{"start":{"row":51,"column":4},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":6717}],[{"start":{"row":51,"column":4},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":6718}],[{"start":{"row":51,"column":4},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":6719}],[{"start":{"row":51,"column":4},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":6720}],[{"start":{"row":50,"column":27},"end":{"row":50,"column":28},"action":"remove","lines":[";"],"id":6721}],[{"start":{"row":50,"column":27},"end":{"row":50,"column":28},"action":"insert","lines":[","],"id":6722}],[{"start":{"row":50,"column":28},"end":{"row":51,"column":0},"action":"insert","lines":["",""],"id":6723}],[{"start":{"row":51,"column":0},"end":{"row":51,"column":1},"action":"insert","lines":["a"],"id":6724}],[{"start":{"row":51,"column":1},"end":{"row":51,"column":2},"action":"insert","lines":["p"],"id":6725}],[{"start":{"row":51,"column":2},"end":{"row":51,"column":3},"action":"insert","lines":["p"],"id":6726}],[{"start":{"row":51,"column":3},"end":{"row":51,"column":4},"action":"insert","lines":["."],"id":6727}],[{"start":{"row":51,"column":4},"end":{"row":51,"column":5},"action":"insert","lines":["u"],"id":6728}],[{"start":{"row":51,"column":5},"end":{"row":51,"column":6},"action":"insert","lines":["s"],"id":6729}],[{"start":{"row":51,"column":6},"end":{"row":51,"column":7},"action":"insert","lines":["e"],"id":6730}],[{"start":{"row":51,"column":7},"end":{"row":51,"column":9},"action":"insert","lines":["()"],"id":6731}],[{"start":{"row":51,"column":8},"end":{"row":51,"column":10},"action":"insert","lines":["\"\""],"id":6732}],[{"start":{"row":51,"column":9},"end":{"row":51,"column":10},"action":"insert","lines":["/"],"id":6733}],[{"start":{"row":51,"column":11},"end":{"row":51,"column":12},"action":"insert","lines":[","],"id":6734}],[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"insert","lines":[" "],"id":6735}],[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"insert","lines":["a"],"id":6736}],[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"insert","lines":["d"],"id":6737}],[{"start":{"row":51,"column":15},"end":{"row":51,"column":16},"action":"insert","lines":["m"],"id":6738}],[{"start":{"row":51,"column":16},"end":{"row":51,"column":17},"action":"insert","lines":["i"],"id":6739}],[{"start":{"row":51,"column":17},"end":{"row":51,"column":18},"action":"insert","lines":["n"],"id":6740}],[{"start":{"row":51,"column":18},"end":{"row":51,"column":19},"action":"insert","lines":["R"],"id":6741}],[{"start":{"row":51,"column":19},"end":{"row":51,"column":20},"action":"insert","lines":["o"],"id":6742}],[{"start":{"row":51,"column":20},"end":{"row":51,"column":21},"action":"insert","lines":["u"],"id":6743}],[{"start":{"row":51,"column":21},"end":{"row":51,"column":22},"action":"insert","lines":["t"],"id":6744}],[{"start":{"row":51,"column":22},"end":{"row":51,"column":23},"action":"insert","lines":["e"],"id":6745}],[{"start":{"row":51,"column":23},"end":{"row":51,"column":24},"action":"insert","lines":["s"],"id":6746}],[{"start":{"row":51,"column":25},"end":{"row":51,"column":26},"action":"insert","lines":[";"],"id":6747}],[{"start":{"row":19,"column":0},"end":{"row":20,"column":0},"action":"insert","lines":["var bookingRoutes   = require(\"./routes/booking\");",""],"id":6748}],[{"start":{"row":19,"column":46},"end":{"row":19,"column":47},"action":"remove","lines":["g"],"id":6749}],[{"start":{"row":19,"column":45},"end":{"row":19,"column":46},"action":"remove","lines":["n"],"id":6750}],[{"start":{"row":19,"column":44},"end":{"row":19,"column":45},"action":"remove","lines":["i"],"id":6751}],[{"start":{"row":19,"column":43},"end":{"row":19,"column":44},"action":"remove","lines":["k"],"id":6752}],[{"start":{"row":19,"column":42},"end":{"row":19,"column":43},"action":"remove","lines":["o"],"id":6753}],[{"start":{"row":19,"column":41},"end":{"row":19,"column":42},"action":"remove","lines":["o"],"id":6754}],[{"start":{"row":19,"column":40},"end":{"row":19,"column":41},"action":"remove","lines":["b"],"id":6755}],[{"start":{"row":19,"column":40},"end":{"row":19,"column":41},"action":"insert","lines":["a"],"id":6756}],[{"start":{"row":19,"column":41},"end":{"row":19,"column":42},"action":"insert","lines":["d"],"id":6757}],[{"start":{"row":19,"column":42},"end":{"row":19,"column":43},"action":"insert","lines":["m"],"id":6758}],[{"start":{"row":19,"column":43},"end":{"row":19,"column":44},"action":"insert","lines":["i"],"id":6759}],[{"start":{"row":19,"column":44},"end":{"row":19,"column":45},"action":"insert","lines":["n"],"id":6760}],[{"start":{"row":19,"column":10},"end":{"row":19,"column":11},"action":"remove","lines":["g"],"id":6761}],[{"start":{"row":19,"column":9},"end":{"row":19,"column":10},"action":"remove","lines":["n"],"id":6762}],[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"remove","lines":["i"],"id":6763}],[{"start":{"row":19,"column":7},"end":{"row":19,"column":8},"action":"remove","lines":["k"],"id":6764}],[{"start":{"row":19,"column":6},"end":{"row":19,"column":7},"action":"remove","lines":["o"],"id":6765}],[{"start":{"row":19,"column":5},"end":{"row":19,"column":6},"action":"remove","lines":["o"],"id":6766}],[{"start":{"row":19,"column":4},"end":{"row":19,"column":5},"action":"remove","lines":["b"],"id":6767}],[{"start":{"row":19,"column":4},"end":{"row":19,"column":5},"action":"insert","lines":["a"],"id":6768}],[{"start":{"row":19,"column":5},"end":{"row":19,"column":6},"action":"insert","lines":["d"],"id":6769}],[{"start":{"row":19,"column":6},"end":{"row":19,"column":7},"action":"insert","lines":["m"],"id":6770}],[{"start":{"row":19,"column":7},"end":{"row":19,"column":8},"action":"insert","lines":["i"],"id":6771}],[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"insert","lines":["n"],"id":6772}],[{"start":{"row":55,"column":0},"end":{"row":96,"column":4},"action":"remove","lines":["//=========ADMIN ROUTES==============","","app.get(\"/admin\", function(req, res){","    res.render(\"admin\");","});","","app.post(\"/admin\", passport.authenticate(\"local\",","{ successRedirect: \"/tp-admin\",","  failureRedirect: \"/admin\",","  failureFlash: true }),","  ","function(req, res) {","   req.flash(\"error\", \"Wrong password/username\");","});","","app.get(\"/tp-admin\", middleware.isLoggedIn, function(req, res){","    res.render(\"tp-admin\");","});","","","/* ============SE USO PARA CREAR 2 USUARIOS Y LUEGO DESHABILITAR===========","","app.get(\"/register\", function(req, res) {","   res.render(\"register\"); ","});","","app.post(\"/register\", function(req, res) {","    var newUser = new User({username: req.body.username});","   User.register(newUser , req.body.password, function(err, user){","      if(err) {","          req.flash(\"error\", err.message);","          return res.redirect(\"/register\");","          ","      } ","      passport.authenticate(\"local\")(req, res, function(){","          req.flash(\"success\", \"Welcome to YelpCamp \" + user.username);","         res.redirect(\"/campgrounds\"); ","      });","   });","});*/"," ","    "],"id":6773}],[{"start":{"row":52,"column":26},"end":{"row":53,"column":4},"action":"remove","lines":["","    "],"id":6774}],[{"start":{"row":52,"column":10},"end":{"row":52,"column":11},"action":"insert","lines":["t"],"id":6775}],[{"start":{"row":52,"column":11},"end":{"row":52,"column":12},"action":"insert","lines":["p"],"id":6776}],[{"start":{"row":52,"column":12},"end":{"row":52,"column":13},"action":"insert","lines":["-"],"id":6777}],[{"start":{"row":52,"column":13},"end":{"row":52,"column":14},"action":"insert","lines":["a"],"id":6778}],[{"start":{"row":52,"column":14},"end":{"row":52,"column":15},"action":"insert","lines":["d"],"id":6779}],[{"start":{"row":52,"column":15},"end":{"row":52,"column":16},"action":"insert","lines":["m"],"id":6780}],[{"start":{"row":52,"column":16},"end":{"row":52,"column":17},"action":"insert","lines":["i"],"id":6781}],[{"start":{"row":52,"column":17},"end":{"row":52,"column":18},"action":"insert","lines":["n"],"id":6782}]]},"ace":{"folds":[],"scrolltop":360,"scrollleft":0,"selection":{"start":{"row":2,"column":4},"end":{"row":2,"column":43},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":23,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1515527236283,"hash":"dd72e97b57f89bb6e46d884dc62cddecb9d28407"}